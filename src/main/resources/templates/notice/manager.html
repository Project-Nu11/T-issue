<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        *{
        cursor: pointer;
        }
        #content-layout{
            display: flex;
            flex-direction: row;
            gap: 10px;
        }
        #noticelist,#details{
            width: 500px;
            height: 400px;
        }
        .details{
            background-color: aqua;
            display: none;
        }
        .detailsdisplay{
            background-color: aqua;
            display: flex;
        }
        #notbtn{
             background: #FAFAC2;
        }
        .content {
            font-size: 35px;
        }
        /*공지사항 리스트 레이아웃*/
        #noticelist{
            width: 30%;
            height: 60%;
            position: absolute;
            left: 19%;
            top: 22%;
            /*border: black 10px solid; !*레이아웃 확인용*!*/
            overflow-y: scroll;
            scrollbar-width: none;
            overflow-x: hidden;
        }
        /*페이지 제목*/
        #pagetitle{
            font-size: 40px;
            position: fixed;
            top: 15%;
            left: 20%;
        }
        /*공지사항 추가버튼*/
        #insertbtn{
            position: fixed;
            top: 15%;
            left: 76%;
            font-size: 20px;
            width: 80px;
            height: 30px;
            background: white;
            border: #d9d9d9 solid 4px;
            border-radius: 8px;
            text-align: center;
            align-content: center;
        }
        /*리스트 레이아웃(한 개당)*/
        .notice{
            height: 50%;
        }
        .title,.content {
            background: white;
            z-index: 1000;
        }
        /*상세 정보 버튼*/
        .detailbtn{
            position: relative;
            top:8%;
            left: 93%;
            z-index: 1001;
            height: 0%;
            font-size: 22px;
        }
        /*공지사항 제목(요약)*/
        .title{
            height: 10%;
            font-size: 22px;
            position: relative;
            padding:3%;
            font-family: AggravoM;

        }
        /*공지사항 내용(요약)*/
        .content{
            height: 60%;
            padding: 3%;
            font-size: 20px;
            font-weight: 400;
            font-family: AggravoL;
            overflow: hidden;
            text-overflow:ellipsis;
            white-space: nowrap;
        }
        /*공백*/
        .empty{
            height: 10%;
            background: rgba(0,0,0,0%);
        }
        /*상세페이지 레이아웃(none)*/
        .details{
            display: none;
        }
        /*상세페이지 레이아웃(flex)*/
        .viewdetails{
            width: 30%;
            height: 60%;
            position: fixed;
            left: 51%;
            top: 22%;
            background: white;
            /*border: black 10px solid; !*레이아웃 확인용*!*/
            display: flex;
            /*justify-content: center;*!*/
            flex-direction: column;
            align-items: center;
        }
        /*상세페이지 내용 레이아웃*/
        #layout{
            padding: 5%;
            font-family: AggravoM;
        }
        /*수정 삭제버튼 레이아웃*/
        #btns{
            position: absolute;
            left: 80%;
            top: 90%;
            width: 100%;
            height: 100%;
        }
        /*수정 삭제 버튼 디자인*/
        #update,#delete{
            font-size: 20px;

            width: 80px;
            height: 30px;
            background: white;
            border: #d9d9d9 solid 4px;
            border-radius: 8px;
            text-align: center;
            align-content: center;
        }





    </style>
</head>
<body>
<div th:include="manager/backgroundandbanner.html"></div>
<div th:include="manager/sidebar.html"></div>
<div id="mainmenu">
    <div id="pagetitle">공지사항 관리</div>
    <div id="insertbtn">추가</div>
    <div id="noticelist">
        <div class="notice" th:each="notice,n : ${noticeList}">
            <div class="detailbtn">▶</div> <!--detailbtn은 여러개있을 수 있고 그에 따른 인덱스 있음-->
<!--            <div th:text="${n.count}"></div> &lt;!&ndash;count 1부터&ndash;&gt;-->
            <div class="title" th:text="${notice.title}"></div>
            <div class="content" th:text="${notice.content}"></div>
            <div class="empty"></div>
        </div>
    </div>
    <div class="details">
        <div style="padding-top: 5%;font-family: AggravoB;font-size: 40px;" >공지사항</div>
        <div id="layout">
            <div style="font-family: AggravoB;font-size: 20px;">제목</div>
            <div id="dtitle" style="font-family: AggravoB;font-size: 20px;"></div>
            <br>
            <div style="font-family: AggravoM;font-size: 20px;">내용</div>
            <div id="dcontent" style="font-family: AggravoL;font-size: 20px;"></div>
            <div id="btns">
                <div id="update">수정</div>
                <div id="delete">삭제</div>
            </div>
        </div>
    </div>
</div>
<script>
    const $detailbtn = document.querySelectorAll('.detailbtn');
    const $detail = document.querySelector('.details');
    const $dtitle = document.getElementById('dtitle');
    const $dcontent = document.getElementById('dcontent');

    let openedIndex = null;
    // 상세버튼 눌렀을 때 모달창 띄우기
    $detailbtn.forEach((btn,i)=>{
        btn.addEventListener('click',function (){


            const $notice = btn.closest('.notice');/*closest() : 가장 가까운 태그로 초기화*/
            const title = $notice.querySelector('.title')?.textContent||'';
            const content = $notice.querySelector('.content')?.textContent||'';

            // 버튼에 해당하는 공지사항 제목,내용 모달창에 띄우기 (비동기)
            $dtitle.textContent=title;
            $dcontent.textContent=content;

            // 인덱스에 해당하는 내용을 가진 모달창이 열려있을 때 상세버튼을 누르면 꺼지게
            if($detail.classList.contains('viewdetails') && openedIndex === i){
                $detail.classList.replace('viewdetails','details')
                openedIndex = null;
                return;
            }

            $detail.classList.replace("details","viewdetails")
            openedIndex = i;
        })
    })




</script>
</body>
</html>